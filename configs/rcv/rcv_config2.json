{
    "type": {
        "value": "train_test_log_to_wandb"
    },
    "model": {
        "desc": null,
        "value": {
            "type": "multi-label-classification-with-infnet",
            "loss_fn": {
                "sign": "-",
                "type": "multi-label-nce-ranking-with-discrete-sampling",
                "log_key": "nce",
                "num_samples": 600
            },
            "sampler": {
                "type": "appending-container",
                "log_key": "sampler",
                "constituent_samplers": []
            },
            "task_nn": {
                "type": "multi-label-text-classification",
                "feature_network": {
                    "feedforward": {
                        "dropout": [
                            0
                        ],
                        "input_dim": 768,
                        "num_layers": 1,
                        "activations": [
                            "linear"
                        ],
                        "hidden_dims": [
                            768
                        ]
                    },
                    "final_dropout": 0,
                    "seq2vec_encoder": {
                        "type": "bert_pooler",
                        "pretrained_model": "bert-base-uncased"
                    },
                    "text_field_embedder": {
                        "token_embedders": {
                            "x": {
                                "type": "pretrained_transformer",
                                "model_name": "bert-base-uncased"
                            }
                        }
                    }
                },
                "label_embeddings": {
                    "embedding_dim": 768,
                    "vocab_namespace": "labels"
                }
            },
            "score_nn": {
                "type": "multi-label-classification",
                "task_nn": {
                    "type": "multi-label-text-classification",
                    "feature_network": {
                        "feedforward": {
                            "dropout": [
                                0
                            ],
                            "input_dim": 768,
                            "num_layers": 1,
                            "activations": [
                                "linear"
                            ],
                            "hidden_dims": [
                                768
                            ]
                        },
                        "final_dropout": 0,
                        "seq2vec_encoder": {
                            "type": "bert_pooler",
                            "pretrained_model": "bert-base-uncased"
                        },
                        "text_field_embedder": {
                            "token_embedders": {
                                "x": {
                                    "type": "pretrained_transformer",
                                    "model_name": "bert-base-uncased"
                                }
                            }
                        }
                    },
                    "label_embeddings": {
                        "embedding_dim": 768,
                        "vocab_namespace": "labels"
                    }
                },
                "global_score": {
                    "type": "multi-label-feedforward",
                    "feedforward": {
                        "input_dim": 103,
                        "num_layers": 1,
                        "activations": "softplus",
                        "hidden_dims": 600
                    }
                }
            },
            "initializer": {
                "regexes": [
                    [
                        ".*feedforward._linear_layers.*weight",
                        {
                            "type": "kaiming_uniform",
                            "nonlinearity": "relu"
                        }
                    ],
                    [
                        ".*feedforward._linear_layers.*bias",
                        {
                            "type": "zero"
                        }
                    ]
                ]
            },
            "inference_module": {
                "type": "multi-label-basic",
                "log_key": "inference_module",
                "loss_fn": {
                    "type": "combination-loss",
                    "log_key": "loss",
                    "reduction": "mean",
                    "loss_weights": [
                        1,
                        1
                    ],
                    "constituent_losses": [
                        {
                            "type": "multi-label-score-loss",
                            "log_key": "neg_nce_score",
                            "reduction": "none",
                            "normalize_y": true
                        },
                        {
                            "type": "multi-label-bce",
                            "log_key": "bce",
                            "reduction": "none"
                        }
                    ]
                }
            },
            "oracle_value_function": {
                "type": "per-instance-f1",
                "differentiable": false
            }
        }
    },
    "_wandb": {
        "desc": null,
        "value": {
            "t": {
                "1": [
                    1,
                    5,
                    11
                ],
                "2": [
                    1,
                    5,
                    11
                ],
                "3": [
                    5,
                    14
                ],
                "4": "3.8.2",
                "5": "0.12.6",
                "6": "4.8.2",
                "8": [
                    5
                ]
            },
            "framework": "huggingface",
            "start_time": 1636801418,
            "cli_version": "0.12.6",
            "is_jupyter_run": false,
            "python_version": "3.8.2",
            "is_kaggle_kernel": false,
            "huggingface_version": "4.8.2"
        }
    },
    "trainer": {
        "desc": null,
        "value": {
            "type": "gradient_descent_minimax",
            "patience": 4,
            "callbacks": [
                "track_epoch_callback",
                "slurm",
                {
                    "type": "wandb_allennlp",
                    "watch_model": false,
                    "sub_callbacks": [
                        {
                            "type": "log_best_validation_metric",
                            "priority": 100
                        }
                    ],
                    "save_model_archive": false
                }
            ],
            "grad_norm": {
                "task_nn": 1,
                "score_nn": 1
            },
            "num_steps": {
                "task_nn": 1,
                "score_nn": 1
            },
            "optimizer": {
                "optimizers": {
                    "task_nn": {
                        "lr": 0.00001,
                        "type": "huggingface_adamw",
                        "weight_decay": 0.1
                    },
                    "score_nn": {
                        "lr": 0.00005,
                        "type": "huggingface_adamw",
                        "weight_decay": 0.1
                    }
                }
            },
            "inner_mode": "score_nn",
            "num_epochs": 300,
            "cuda_device": 0,
            "checkpointer": {
                "keep_most_recent_by_count": 1
            },
            "validation_metric": "+fixed_f1",
            "learning_rate_schedulers": {
                "task_nn": {
                    "mode": "max",
                    "type": "reduce_on_plateau",
                    "factor": 0.5,
                    "verbose": true,
                    "patience": 1
                }
            }
        }
    },
    "vocabulary": {
        "desc": null,
        "value": {
            "type": "from_files",
            "directory": "data/rcv1/bert_vocab"
        }
    },
    "data_loader": {
        "desc": null,
        "value": {
            "num_workers": 5,
            "start_method": "spawn",
            "batch_sampler": {
                "type": "bucket",
                "batch_size": 16,
                "sorting_keys": [
                    "x"
                ]
            },
            "max_instances_in_memory": 1000
        }
    },
    "dataset_reader": {
        "desc": null,
        "value": {
            "type": "rcv",
            "tokenizer": {
                "type": "pretrained_transformer",
                "max_length": 512,
                "model_name": "bert-base-uncased"
            },
            "token_indexers": {
                "x": {
                    "type": "pretrained_transformer",
                    "model_name": "bert-base-uncased"
                }
            }
        }
    },
    "test_data_path": {
        "desc": null,
        "value": "data/rcv1/test_fold_0.jsonl"
    },
    "env.num_samples": {
        "desc": null,
        "value": 600
    },
    "train_data_path": {
        "desc": null,
        "value": "data/rcv1/train_val_fold_@(0|1|2|3|4|5).jsonl"
    },
    "evaluate_on_test": {
        "desc": null,
        "value": true
    },
    "validation_data_path": {
        "desc": null,
        "value": "data/rcv1/train_val_fold_@(6|7|8|9).jsonl"
    },
    "env.score_loss_weight": {
        "desc": null,
        "value": 1
    }
}